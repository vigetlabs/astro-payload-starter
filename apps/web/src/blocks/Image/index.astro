---
import { Image } from 'astro:assets'
import type { ImageBlockFields } from '@repo/cms'
import { resolveImage } from '@/helpers/resolveImage'

interface Props {
  imageBlockFields: ImageBlockFields
}

const { imageBlockFields } = Astro.props
const { image } = imageBlockFields
const resolvedImage = image && resolveImage(image)
---

<figure>
  {
    resolvedImage && (
      <Image src={resolvedImage.url} alt={resolvedImage.alt} inferSize={true} />
    )
  }
  {
    imageBlockFields.caption && (
      <figcaption>
        TODO: convert caption JSON to HTML and render it here
        {/* {imageBlockFields.caption} */}
      </figcaption>
    )
  }
</figure>
