---
import { Image } from 'astro:assets'
import type { ImageBlockFields } from '@repo/cms'
import { resolveImage } from '@/helpers/resolveImage'

interface Props {
  imageBlockFields: ImageBlockFields
}

const { imageBlockFields } = Astro.props
const { image, caption_html } = imageBlockFields
const resolvedImage = image && resolveImage(image)
---

<figure>
  {
    resolvedImage && (
      <Image src={resolvedImage.url} alt={resolvedImage.alt} inferSize={true} />
    )
  }
  {
    imageBlockFields.caption && (
      <figcaption set:html={imageBlockFields.caption_html} />
    )
  }
</figure>
