---
import type { LinkField, Header } from '@repo/cms'
import { getHeaderGlobals } from '@/api'
import Link from './Link.astro'

interface Props {
  home: boolean
}

const headerData = (await getHeaderGlobals()) as Header
const { tabs, ctas } = headerData
const { home } = Astro.props
---

<header>
  {home && <h1>Logo</h1>}
  {!home && <a href="/">Logo</a>}
  <nav>
    {
      tabs?.map(({ label, type, link, dropdownLinks }) => {
        switch (type) {
          case 'dropdown':
            return (
              <details>
                <summary>{label}</summary>
                <ul class="dropdown">
                  {dropdownLinks?.map(({ link }) => (
                    <li>
                      <Link {...(link as LinkField)} />
                    </li>
                  ))}
                </ul>
              </details>
            )
          case 'directLink': {
            return <Link {...(link as LinkField)} />
          }
        }
      })
    }
    {ctas?.map(({ link }) => <Link {...(link as LinkField)} />)}
  </nav>
</header>

<style>
  header {
    align-items: center;
    background-color: #111;
    color: white;
    display: flex;
    gap: 1rem;
    padding: 1rem;

    a {
      color: #fff;
    }
  }

  nav {
    align-items: center;
    display: flex;
    gap: 1rem;
    list-style: none;
  }

  summary {
    cursor: pointer;
    user-select: none;
  }

  .dropdown {
    background: #555;
    list-style: none;
    padding: 0.5rem;
    position: absolute;
  }
</style>
